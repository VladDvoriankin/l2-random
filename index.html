<!DOCTYPE html>
<html>
	<head>
		<title>Lineage 2 - помошник выбора класса</title>
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<link href="https://fonts.googleapis.com/css2?family=Amatic+SC&amp;display=swap" rel="stylesheet">
		<style type="text/css">
			/*html, body {
				height: 100%;
				margin: 1em;
			}*/
			body {
				font-family: 'Amatic SC', cursive;
				font-size: 16px;
				background: #222836;
				color: #e2e2e2;
				/*display: flex;
				justify-content: center;
				align-items: center;*/
			}
			.disabled {
				opacity: 0.1;
			}

			#options img,
			button {
				cursor: pointer;
			}
		</style>
	</head>
	<body>
		<p>
			<button type="button" id="disableAll">убрать все</button>
			<button type="button" id="selectMelee">выбрать милишников</button>
			<button type="button" id="selectRange">выбрать ренджей</button>
			<button type="button" id="selectSummoners">выбрать саммонеров</button>
			<button type="button" id="selectBuffers">выбрать бафферов</button>
			<button type="button" id="selectTankers">выбрать танков</button>
			<button type="button" id="selectAll">выбрать все</button>
		</p>
		<div id="options"></div>
		<p>
			<button type="button" id="run">ага</button>
		</p>
		<div id="result"></div>
		<script type="text/javascript">
			const imgPrefix = 'https://l2db.ru/themes/l2db/images/classes/';
			const imgAffix = '.png';
			const classes = [{"title":"berserker","imgName":"kamael_berserker","race":"kamael"},{"title":"soul breaker","imgName":"kamael_soul_breaker","race":"kamael"},{"title":"arbalester","imgName":"kamael_arbalester","race":"kamael"},{"title":"warlord","imgName":"human_warlord","race":"human"},{"title":"gladiator","imgName":"human_gladiator","race":"human"},{"title":"paladin","imgName":"human_paladin","race":"human"},{"title":"dark avenger","imgName":"human_dark_avenger","race":"human"},{"title":"treasure hunter","imgName":"human_treasure_hunter","race":"human"},{"title":"hawkeye","imgName":"human_hawkeye","race":"human"},{"title":"sorcerer","imgName":"human_sorcerer","race":"human"},{"title":"necromancer","imgName":"human_necromancer","race":"human"},{"title":"warlock","imgName":"human_warlock","race":"human"},{"title":"bishop","imgName":"human_bishop","race":"human"},{"title":"prophet","imgName":"human_prophet","race":"human"},{"title":"swordsinger","imgName":"elf_swordsinger","race":"elf"},{"title":"temple knight","imgName":"elf_temple_knight","race":"elf"},{"title":"plainswalker","imgName":"elf_plainswalker","race":"elf"},{"title":"silver ranger","imgName":"elf_silver_ranger","race":"elf"},{"title":"elemental summoner","imgName":"elf_elemental_summoner","race":"elf"},{"title":"spellsinger","imgName":"elf_spellsinger","race":"elf"},{"title":"elder","imgName":"elf_elder","race":"elf"},{"title":"destroyer","imgName":"orc_destroyer","race":"orc"},{"title":"tyrant","imgName":"orc_tyrant","race":"orc"},{"title":"overlord","imgName":"orc_overlord","race":"orc"},{"title":"warcryer","imgName":"orc_warcryer","race":"orc"},{"title":"shillien knight","imgName":"darkelf_shillien_knight","race":"darkelf"},{"title":"bladedancer","imgName":"darkelf_bladedancer","race":"darkelf"},{"title":"abyss walker","imgName":"darkelf_abyss_walker","race":"darkelf"},{"title":"phantom ranger","imgName":"darkelf_phantom_ranger","race":"darkelf"},{"title":"spellhowler","imgName":"darkelf_spellhowler","race":"darkelf"},{"title":"phantom summoner","imgName":"darkelf_phantom_summoner","race":"darkelf"},{"title":"shillien elder","imgName":"darkelf_shillien_elder","race":"darkelf"},{"title":"bounty hunter","imgName":"dwarf_bounty_hunter","race":"dwarf"},{"title":"warsmith","imgName":"dwarf_warsmith","race":"dwarf"}];

			const onSettingClick = (e, id) => {
				e.preventDefault();

				classes[id].disabled = !classes[id].disabled;
				renderOptions();
			};

			const $options = document.querySelector('#options');
			const $result = document.querySelector('#result');

			const renderOptions = () => {
				const $docFrag = document.createDocumentFragment();
				const images = classes.forEach(({title, imgName, race, disabled = false}, id) => {
					const img = document.createElement('img');

					img.src = imgPrefix + imgName + imgAffix;

					if (disabled) {
						img.classList.add('disabled');
					}

					img.addEventListener('click', e => onSettingClick(e, id), false);
					$docFrag.appendChild(img);
				});

				$options.innerHTML = '';
				$options.appendChild($docFrag);
			};

			renderOptions();

			function random() {
				const arr = classes.filter(({disabled}) => !disabled);
				const randIndex = Math.floor(Math.random() * arr.length);
				const {imgName} = arr[randIndex];

				console.log(arr, randIndex, imgName)

				const img = document.createElement('img');

				img.src = imgPrefix + imgName + imgAffix;

				$result.innerHTML = '';
				$result.appendChild(img);
			}

			document.querySelector('#selectAll').addEventListener('click', () => {
				for (let i = 0; i < classes.length; i++) {
					classes[i].disabled = false;
				}
				renderOptions();
			}, false);
			document.querySelector('#disableAll').addEventListener('click', () => {
				for (let i = 0; i < classes.length; i++) {
					classes[i].disabled = true;
				}
				renderOptions();
			}, false);

			const hasImageName = name => typeof classes.find(({imgName}) => imgName === name) !== 'undefined';

			const selectArr = arr => {
				for (let i = 0; i < classes.length; i++) {
					const cl = classes[i];

					cl.disabled = typeof arr.find(n => n === cl.imgName) === 'undefined';
				}
				renderOptions();
			};

			document.querySelector('#selectMelee').addEventListener('click', () => {
				selectArr(["kamael_berserker","kamael_soul_breaker","human_warlord","human_gladiator","human_paladin","human_dark_avenger","human_treasure_hunter","elf_swordsinger","elf_temple_knight","elf_plainswalker","orc_destroyer","orc_tyrant","darkelf_shillien_knight","darkelf_bladedancer","darkelf_abyss_walker","dwarf_bounty_hunter","dwarf_warsmith"])
			}, false);
			document.querySelector('#selectRange').addEventListener('click', () => {
				selectArr(["kamael_soul_breaker","kamael_arbalester","human_hawkeye","human_sorcerer","human_necromancer","elf_silver_ranger","elf_spellsinger","darkelf_phantom_ranger","darkelf_spellhowler"])
			}, false);
			document.querySelector('#selectSummoners').addEventListener('click', () => {
				selectArr(["human_paladin","human_dark_avenger","human_necromancer","human_warlock","elf_elemental_summoner","darkelf_phantom_summoner","dwarf_warsmith"])
			}, false);
			document.querySelector('#selectBuffers').addEventListener('click', () => {
				selectArr(["human_bishop","human_prophet","elf_swordsinger","elf_elder","orc_overlord","orc_warcryer","darkelf_bladedancer","darkelf_shillien_elder"])
			}, false);
			document.querySelector('#selectTankers').addEventListener('click', () => {
				selectArr(["human_paladin","human_dark_avenger","elf_temple_knight","darkelf_shillien_knight","darkelf_bladedancer","elf_swordsinger"])
			}, false);

			document.querySelector('#run').addEventListener('click', random, false);
		</script>
	</body>
</html>
